import os
from docx import Document
from docx.shared import Pt
from docx.oxml.ns import qn
from docx.enum.text import WD_PARAGRAPH_ALIGNMENT, WD_LINE_SPACING

# 评语列表
comments = [
    "该组同学实训报告完成态度认真，在英语翻译部分，对于专业术语的翻译较为准确，语句通顺度方面表现良好，整体完成情况较好。",
    "此组同学实训报告完成得较为扎实，英语翻译的第一部分紧扣要点，译文能准确传达原文意思，其他部分也都按要求完成，质量不错。",
    "该小组同学在实训报告中，英语翻译内容基本涵盖关键信息，翻译准确，语法错误较少，整体完成情况令人满意。",
    "这组同学实训报告完成认真，英语翻译部分对长难句的处理较为得当，基本能做到忠实原文，整体效果较好。",
    "该组同学的实训报告，英语翻译部分完成度较高，词义理解准确，语句表达自然，其他部分也有不错的表现。",
    "此组同学在实训报告的英语翻译中，能抓住核心内容进行翻译，翻译的准确性较高，整体完成情况良好。",
    "该小组同学实训报告里的英语翻译，基本要点都有涉及，翻译思路清晰，译文质量较为稳定，整体完成情况较好。",
    "这组同学实训报告完成得认真负责，英语翻译部分用词恰当，能准确体现原文风格，其他部分也完成得不错。",
    "该组同学实训报告的英语翻译，在内容完整性上表现良好，对原文的翻译较为准确，整体表现可圈可点。",
    "此组同学实训报告中的英语翻译，能够按照要求完成，翻译准确且表意清晰，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，对原文信息的把握准确，译文质量较高。",
    "这组同学实训报告完成认真，英语翻译部分对专业词汇的翻译精准，语句连贯性好，整体完成度不错。",
    "该组同学实训报告的英语翻译，大部分内容准确无误，对原文的理解较为到位，整体完成情况良好。",
    "此组同学在实训报告的英语翻译中，能准确传达原文大意，翻译技巧运用得当，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，基本能将原文信息完整呈现，翻译质量较高，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法正确，用词准确，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整且翻译准确，对原文的风格把握较好，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确地将原文翻译成英文，语句通顺，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解透彻，翻译精准。",
    "这组同学实训报告完成认真，英语翻译部分对一些复杂句式的处理较为巧妙，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，语言表达自然流畅，整体完成情况较为理想。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文的逻辑，翻译准确，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，信息传达准确，翻译符合英语表达习惯，整体完成情况较好。",
    "这组同学实训报告完成得认真负责，英语翻译部分用词准确，语句通顺，整体完成度较高。",
    "该组同学实训报告的英语翻译，在内容和形式上都较好地体现了原文，翻译准确，整体表现良好。",
    "此组同学实训报告中的英语翻译，能准确把握原文意思，翻译质量较高，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，译文忠实于原文，语句连贯。",
    "这组同学实训报告完成认真，英语翻译部分对专业术语的处理恰当，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本准确传达了原文信息，语言表达较为流畅，整体完成情况不错。",
    "此组同学在实训报告的英语翻译中，能准确理解原文并进行翻译，译文质量较高，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，要点突出，翻译准确无误，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法正确，表意清晰，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整，翻译准确，对原文风格的再现较为成功，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确地将原文内容转化为英文，语句通顺自然，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解深入，翻译精准到位。",
    "这组同学实训报告完成认真，英语翻译部分对复杂句子的翻译处理得当，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，表达符合英语语言习惯，整体完成情况较为理想。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文的主旨，翻译准确，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，信息传达准确无误，翻译符合英语表达规范，整体完成情况较好。",
    "这组同学实训报告完成得认真负责，英语翻译部分用词精准，语句连贯，整体完成度较高。",
    "该组同学实训报告的英语翻译，在内容和形式上都较好地契合了原文，翻译准确，整体表现良好。",
    "此组同学实训报告中的英语翻译，能准确把握原文含义，翻译质量较高，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，译文忠实于原文，语言流畅。",
    "这组同学实训报告完成认真，英语翻译部分对专业词汇的翻译准确，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本准确地传达了原文信息，语言表达较为通顺，整体完成情况不错。",
    "此组同学在实训报告的英语翻译中，能准确理解原文并进行恰当翻译，译文质量较高，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，要点明确，翻译准确无误，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法无误，表意清晰，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整且准确，对原文风格的把握较为到位，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确地将原文转化为英文，语句通顺自然，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解透彻，翻译精准恰当。",
    "这组同学实训报告完成认真，英语翻译部分对复杂句式的处理较为巧妙，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，表达符合英语习惯，整体完成情况较为理想。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文的逻辑关系，翻译准确，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，信息传达准确，翻译符合英语表达特点，整体完成情况较好。",
    "这组同学实训报告完成得认真负责，英语翻译部分用词准确，语句连贯，整体完成度较高。",
    "该组同学实训报告的英语翻译，在内容和形式上都较好地体现了原文，翻译准确，整体表现良好。",
    "此组同学实训报告中的英语翻译，能准确把握原文意思，翻译质量较高，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，译文忠实于原文，语句通顺。",
    "这组同学实训报告完成认真，英语翻译部分对专业术语的处理恰当，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本准确传达了原文信息，语言表达较为流畅，整体完成情况不错。",
    "此组同学在实训报告的英语翻译中，能准确理解原文并进行翻译，译文质量较高，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，要点突出，翻译准确无误，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法正确，表意清晰，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整，翻译准确，对原文风格的再现较为成功，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确地将原文内容转化为英文，语句通顺自然，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解深入，翻译精准到位。",
    "这组同学实训报告完成认真，英语翻译部分对复杂句子的翻译处理得当，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，表达符合英语语言习惯，整体完成情况较为理想。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文的主旨，翻译准确，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，信息传达准确无误，翻译符合英语表达规范，整体完成情况较好。",
    "这组同学实训报告完成得认真负责，英语翻译部分用词精准，语句连贯，整体完成度较高。",
    "该组同学实训报告的英语翻译，在内容和形式上都较好地契合了原文，翻译准确，整体表现良好。",
    "此组同学实训报告中的英语翻译，能准确把握原文含义，翻译质量较高，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，译文忠实于原文，语言流畅。",
    "这组同学实训报告完成认真，英语翻译部分对专业词汇的翻译准确，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本准确地传达了原文信息，语言表达较为通顺，整体完成情况不错。",
    "此组同学在实训报告的英语翻译中，能准确理解原文并进行恰当翻译，译文质量较高，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，要点明确，翻译准确无误，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法无误，表意清晰，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整且准确，对原文风格的把握较为到位，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确地将原文转化为英文，语句通顺自然，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解透彻，翻译精准恰当。",
    "这组同学实训报告完成认真，英语翻译部分对复杂句式的处理较为巧妙，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，表达符合英语习惯，整体完成情况较为理想。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文的逻辑关系，翻译准确，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，信息传达准确，翻译符合英语表达特点，整体完成情况较好。",
    "这组同学实训报告完成得认真负责，英语翻译部分用词准确，语句连贯，整体完成度较高。",
    "该组同学实训报告的英语翻译，在内容和形式上都较好地体现了原文，翻译准确，整体表现良好。",
    "此组同学实训报告中的英语翻译，能准确把握原文意思，翻译质量较高，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，译文忠实于原文，语句通顺。",
    "这组同学实训报告完成认真，英语翻译部分对专业术语的处理恰当，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本准确传达了原文信息，语言表达较为流畅，整体完成情况不错。",
    "此组同学在实训报告的英语翻译中，能准确理解原文并进行翻译，译文质量较高，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，要点突出，翻译准确无误，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法正确，表意清晰，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整，翻译准确，对原文风格的再现较为成功，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确地将原文内容转化为英文，语句通顺自然，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解深入，翻译精准到位。",
    "这组同学实训报告完成认真，英语翻译部分对复杂句子的翻译处理得当，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，表达符合英语语言习惯，整体完成情况较为理想。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文的主旨，翻译准确，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，信息传达准确无误，翻译符合英语表达规范，整体完成情况较好。",
    "这组同学实训报告完成得认真负责，英语翻译部分用词精准，语句连贯，整体完成度较高。",
    "该组同学实训报告的英语翻译，在内容和形式上都较好地契合了原文，翻译准确，整体表现良好。",
    "此组同学实训报告中的英语翻译，能准确把握原文含义，翻译质量较高，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，译文忠实于原文，语言流畅。",
    "这组同学实训报告完成认真，英语翻译部分对专业词汇的翻译准确，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本准确地传达了原文信息，语言表达较为通顺，整体完成情况不错。",
    "此组同学在实训报告的英语翻译中，能准确理解原文并进行恰当翻译，译文质量较高，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，要点明确，翻译准确无误，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法无误，表意清晰，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整且准确，对原文风格的把握较为到位，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确地将原文转化为英文，语句通顺自然，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解透彻，翻译精准恰当。",
    "这组同学实训报告完成认真，英语翻译部分对复杂句式的处理较为巧妙，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，表达符合英语习惯，整体完成情况较为理想。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文的逻辑关系，翻译准确，整体完成情况不错。",
    "该小组同学实训报告的英语翻译，对多数内容的翻译精准，不过在个别长句的处理上可更优化，整体完成情况较好。",
    "这组同学实训报告完成态度端正，英语翻译部分基本准确传达了文意，若能进一步提升语句的流畅度会更好，整体表现不错。",
    "该组同学实训报告中的英语翻译，大部分要点抓得准确，翻译过程中能较好地运用常见技巧，整体完成情况值得肯定。",
    "此组同学实训报告的英语翻译完成得较认真，对原文的理解基本到位，翻译中个别词汇的选择可再斟酌，整体完成度良好。",
    "该小组同学在实训报告英语翻译方面，展现出一定能力，语句翻译准确，部分复杂内容若能更清晰表达会更优，整体情况不错。",
    "这组同学实训报告完成认真，英语翻译部分对专业内容的翻译较为精准，日常表达的翻译可适当优化，整体完成情况较好。",
    "该组同学实训报告的英语翻译，能把握主要内容准确翻译，细节之处若能更加完善，整体质量会进一步提升，目前完成情况良好。",
    "此组同学在实训报告的英语翻译中，整体思路清晰，翻译结果基本符合要求，某些生僻词汇的翻译可多查阅资料，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，大部分信息翻译准确，在语言风格的统一上还可加强，整体完成情况令人满意。",
    "这组同学实训报告完成得认真负责，英语翻译部分对原文的解读较准确，翻译时可注意句式的多样性，整体完成度较高。",
    "该组同学实训报告的英语翻译，内容完整且多数翻译正确，部分语句稍显生硬，可进一步润色，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够准确传达大部分原文信息，少数表述可再优化以更符合英语表达习惯，整体完成情况值得认可。",
    "该小组同学在实训报告的英语翻译方面，完成得较为用心，对原文信息的提取和翻译都较准确，偶尔出现小失误，整体完成情况较好。",
    "这组同学实训报告完成认真，英语翻译部分对专业词汇的把握精准，在一些连接词的使用上可更恰当，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本准确传达了原文含义，个别地方的翻译若能结合上下文会更贴切，整体完成情况不错。",
    "此组同学在实训报告的英语翻译中，能准确理解原文并进行翻译，部分长难句的翻译可尝试更多技巧，整体完成情况较好。",
    "该小组同学实训报告里的英语翻译，要点基本覆盖且翻译准确，在一些复杂修饰成分的处理上可更细致，整体完成情况令人满意。",
    "这组同学实训报告完成得认真踏实，英语翻译部分语法正确，部分词汇的选用可更灵活，整体完成效果不错。",
    "该组同学实训报告的英语翻译，内容完整且翻译质量较高，在一些习惯用语的翻译上可更贴近英语母语者的表达，整体表现良好。",
    "此组同学实训报告中的英语翻译，能够将原文准确地转化为英文，部分段落的连贯性可进一步提升，整体完成情况值得肯定。",
    "该小组同学在实训报告的英语翻译方面，完成得比较出色，对原文的理解深入，部分特殊语境下的翻译可再打磨，整体完成情况优秀。",
    "这组同学实训报告完成认真，英语翻译部分对复杂句式的处理有一定技巧，部分表述可更简洁明了，整体完成情况良好。",
    "该组同学实训报告的英语翻译，基本要点准确，语言表达较流畅，在一些专业领域的特定表达上可再学习，整体完成情况较好。",
    "此组同学在实训报告的英语翻译中，能很好地把握原文主旨，翻译过程中部分词汇的准确性可再确认，整体完成情况不错。",
    "该小组同学实训报告里的英语翻译，信息传达准确，整体翻译质量较好，在一些细微语义的差别上可进一步钻研，整体完成情况令人满意。",

]

# 文件夹路径
folder_path = './'

# 获取文件夹中的所有 Word 文档文件
files = [file for file in os.listdir(folder_path) if file.endswith('.docx')]

# 确保文件个数与评语数量一致
if len(files) > len(comments):
    print(f"[{len(files)}]评语数量不足！")
else:
    # 遍历文件并填入评语
    for idx, filename in enumerate(files):
        # 加载 Word 文档
        doc_path = os.path.join(folder_path, filename)
        doc = Document(doc_path)

        # 填入评语到表格
        table = doc.tables[0]  # 假定第一个表格为目标表格
        for row in table.rows:
            for i, cell in enumerate(row.cells): 
                if '指导教师评阅意见' in cell.text:
                    cell_to_fill = row.cells[i+1]
                    cell_to_fill.text = '    ' + comments[-1]

                    # 设置字体和大小
                    for paragraph in cell_to_fill.paragraphs:
                        for run in paragraph.runs:
                            run.font.name = '宋体'  # 设置字体
                            run._element.rPr.rFonts.set(qn('w:eastAsia'), '宋体')
                            run.font.size = Pt(12)  # 设置字体大小

                        # 设置行距
                        paragraph.paragraph_format.line_spacing_rule = WD_LINE_SPACING.EXACTLY
                        paragraph.paragraph_format.line_spacing = Pt(21)  # 设置行距为21磅(1.5倍)
                
                if '指导老师签名和日期' in cell.text:
                    cell_to_fill = row.cells[i+1]
                    paragraph = cell_to_fill.paragraphs[0]
                    run = paragraph.add_run()
                    run.add_picture('./sign.png', width=Pt(100))  # 插入图片并设置宽度
                    paragraph.alignment = WD_PARAGRAPH_ALIGNMENT.CENTER  # 设置居中对齐

        # 保存修改后的文档
        doc.save(doc_path)
        print(f"评语{idx+1}和签名已成功填入{filename}")
